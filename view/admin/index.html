<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <title>管理</title>
  <meta content="#1f2937" name="apple-mobile-web-app-status-bar-style">   
  <script src="../common/jquery-3.7.0.js"></script>
  <script src="../common/tailwind-3.3.2.js"></script>
  <link href="../common/common.css" type="text/css" rel="stylesheet" />
</head>

<body class="bg-gray-700 text-slate-200">
  <div id="loading" class="fixed w-full h-screen bg-gray-800 z-10 flex items-center justify-center">
    <svg class="animate-spin h-10 w-10 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor"
        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
      </path>
    </svg>
  </div>
  <div class="relative flex h-12 w-full items-center justify-between px-4 bg-gray-800">
    <a class="flex items-center" href="/app">
      <svg class="shrink-0 text-primary-600 h-9 shrink-0 pr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
        fill="currentColor" class="w-6 h-6">
        <path
          d="M11.7 2.805a.75.75 0 01.6 0A60.65 60.65 0 0122.83 8.72a.75.75 0 01-.231 1.337 49.949 49.949 0 00-9.902 3.912l-.003.002-.34.18a.75.75 0 01-.707 0A50.009 50.009 0 007.5 12.174v-.224c0-.131.067-.248.172-.311a54.614 54.614 0 014.653-2.52.75.75 0 00-.65-1.352 56.129 56.129 0 00-4.78 2.589 1.858 1.858 0 00-.859 1.228 49.803 49.803 0 00-4.634-1.527.75.75 0 01-.231-1.337A60.653 60.653 0 0111.7 2.805z" />
        <path
          d="M13.06 15.473a48.45 48.45 0 017.666-3.282c.134 1.414.22 2.843.255 4.285a.75.75 0 01-.46.71 47.878 47.878 0 00-8.105 4.342.75.75 0 01-.832 0 47.877 47.877 0 00-8.104-4.342.75.75 0 01-.461-.71c.035-1.442.121-2.87.255-4.286A48.4 48.4 0 016 13.18v1.27a1.5 1.5 0 00-.14 2.508c-.09.38-.222.753-.397 1.11.452.213.901.434 1.346.661a6.729 6.729 0 00.551-1.608 1.5 1.5 0 00.14-2.67v-.645a48.549 48.549 0 013.44 1.668 2.25 2.25 0 002.12 0z" />
        <path
          d="M4.462 19.462c.42-.419.753-.89 1-1.394.453.213.902.434 1.347.661a6.743 6.743 0 01-1.286 1.794.75.75 0 11-1.06-1.06z" />
      </svg>
      <div class="pr-6 font-sans sm:flex max-sm:hidden appName">
        Loading...
      </div>
    </a>
    <div class="flex">
      <div id="userName" class="mr-1 text-gray-400"></div>
      <div id="userRole" class="mr-2 text-gray-400"></div>
      <svg onclick="exit()" class="w-6 h-6 cursor-pointer" xmlns="http://www.w3.org/2000/svg" fill="none"
        viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9" />
      </svg>
    </div>
  </div>
  <div style="min-height: calc(100vh - 170px);" class="mx-auto pt-3 w-full max-w-6xl px-4">
    <div class="sm:flex">
      <div class="sm:mr-3 mb-3">
        <div
          class="sm:col-span-1 mb-3 rounded-2xl h-10 flex items-center justify-center transition-all duration-300 cursor-pointer bg-gray-600 hover:bg-gray-800">
          <div>导入题目</div>
        </div>
        <div class="sm:col-span-1 sm:row-span-2 rounded-xl duration-300 bg-gray-600 mb-3">
          <div class="pl-3 pt-2 border-b pb-2 border-gray-500">科目管理</div>
          <div id="subjectList" class="overflow-y-auto max-h-80"></div>
        </div>
        <div class="sm:col-span-1 sm:row-span-2 rounded-xl duration-300 bg-gray-600 p-3">
          <label class="font-semibold text-sm pb-1 block">科目名称</label>
          <input type="text" class="border rounded-lg px-3 py-2 mt-1 mb-2 bg-gray-500 border-none text-gray-100 text-sm w-full" name="subName" />
          <label class="font-semibold text-sm pb-1 block">描述标签</label>
          <input type="text" class="border rounded-lg px-3 py-2 mt-1 mb-3 bg-gray-500 border-none text-gray-100 text-sm w-full" name="subTag" />
          <button type="button" id="login"
            class="transition duration-200 bg-blue-600 hover:bg-blue-500 focus:bg-blue-700 focus:shadow-sm focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 text-white w-full py-2.5 rounded-lg text-sm shadow-sm hover:shadow-md font-semibold text-center">
            添加
          </button>
        </div>
      </div>
      <div class="sm:col-span-3 sm:row-span-3 w-full rounded-xl duration-300 bg-gray-600"
        style="min-height: calc(100vh - 120px);">
        <div class="pl-3 pt-2 border-b pb-2 border-gray-500">科目管理</div>
        <div class="flex items-center justify-center h-96">
          <div>此功能暂不支持</div>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="../common/common.js"></script>
<script>
  (function () {
    if (checkLogin()) getSubjectList();
  })()

  var token = '';
  var user = {};
  function checkLogin() {
    token = localStorage.getItem('accessToken')
    if (token == '' || token == undefined) return jump('auth')
    else {
      user = JSON.parse(localStorage.getItem('cacheUser'))
      $('#userName').text(user.name.toUpperCase())
      $('#userRole').text(user.admin ? '管理员' : '同学')
      if (user.admin) {
        $('#menu').removeClass('lg:grid-cols-3');
        $('#menu').addClass('lg:grid-cols-4');
        $('#appAdmin').show()
      } else {
        $('#appAdmin').remove()
      }
      return true
    }
  }

  function jump(path) {
    window.location.href = '/app/' + path
  }

  function exit() {
    localStorage.clear()
    jump('auth')
  }

  var subjectList = []
  function getSubjectList() {
    $.ajax({
      url: '/api/subject/list',
      method: "GET",
      headers: {
        Authorization: 'Bearer ' + token
      },
    }).done(function (res) {
      if (res.list) {
        subjectList = res.list
        for (let i in subjectList) {
          var item = subjectList[i];
          $('#subjectList').append(`<div class="flex items-center justify-between mb-3 px-3 py-2 hover:bg-gray-500"><div><div class="text-md line1 w-56">${item.name}</div><div class="text-sm text-gray-400">${item.tag}</div></div><svg class="text-red-600 w-8 h-8 p-1 cursor-pointer hover:text-red-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg></div>`)
        }
      } else {

      }
    });
  }
</script>

</html>